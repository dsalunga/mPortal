var WCMS=window.WCMS||{};WCMS.Social={bindCommentHover:function(n){n.hover(function(){var n=$(this).find("a.commentDeleteButton");n.css("background-position","0 0");n.css("visibility","visible")},function(){$(this).find("a.commentDeleteButton").css("visibility","hidden")})},bindDeleteButtonHover:function(n){n.hover(function(){$(this).css("background-position","0 -32px")},function(){$(this).css("background-position","0 0")})},bindPostHover:function(n){n.hover(function(){var n=$(this).find("a.postDeleteButton");n.css("background-position","0 0");n.css("visibility","visible")},function(){$(this).find("a.postDeleteButton").css("visibility","hidden")})},bindPostDeleteClick:function(n){n.click(function(n){var t=$(n.target).parents("div.panelWallPost").data("post"),i=$("body").data("fx");i.userId>0&&confirm("Are you sure you want to delete this post?")&&$.ajax({type:"POST",url:"/Content/Parts/Social/WebService.asmx/DeleteWallEntry",data:JSON.stringify({id:t.id}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){n.d&&$("#panelWallUpdates div#wallPost"+t.id).remove()},error:function(n){alert(n.responseText)}})})},bindCommentDeleteClick:function(n){n.click(function(n){var t=$(n.target).parents("div.commentItem"),i=t.data("comment"),r=$("body").data("fx");r.userId>0&&confirm("Are you sure you want to delete this comment?")&&$.ajax({type:"POST",url:"/Content/Parts/Common/FxService.asmx/DeleteComment",data:JSON.stringify({id:i.id}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){n.d&&t.remove()},error:function(n){alert(n.responseText)}})})},bindNewCommentKeypress:function(n){n.keyup(function(n){n.keyCode==8&&WCMS.Social.autoSizeTextbox($(n.target),14,14)});n.each(function(){var n=$(this),t=$(this).next("input[type='button']");$(t).click(function(){WCMS.Social.postCommentAjax(n)})});n.keypress(function(n){var t=$(n.target);n.which!=13||n.shiftKey?(n.which==13||n.which==8)&&WCMS.Social.autoSizeTextbox(t,14,14):WCMS.Social.postCommentAjax(t)})},postCommentAjax:function(n){var t=$(n).val(),i=$(n).parents("div.panelWallPost").data("post"),r=$("body").data("fx");r.userId>0&&!t.isEmpty()?$.ajax({type:"POST",url:"/Content/Parts/Common/FxService.asmx/PostComment",data:JSON.stringify({commentText:t,userId:r.userId,targetObjectId:i.oid,targetRecordId:i.rid}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){var u=$(n).parents("div.panelComments").children("div.allComments"),i,r;u.append(t.d);i=$(u).find("div.commentItem");r=i.find("a.commentDeleteButton");WCMS.Social.bindCommentHover(i);WCMS.Social.bindDeleteButtonHover(r);WCMS.Social.bindCommentDeleteClick(r);$(n).val("")},error:function(n){alert(n.responseText)}}):$(n).val("")},bindCommentLinkClick:function(n){n.click(function(){var n=$(this).parent().siblings("div.panelComments");$(n).css("display").toLowerCase().indexOf("none")>-1&&$(n).css("display","block")})},bindNewPostFocus:function(){var n=$("div#panelNewWallPost textarea.newPostText");n.length>0&&(n.focus(function(){var n=$("div#panelNewWallPost div.uiPostControlContainer");n.css("display").toLowerCase().indexOf("block")<=-1&&($(this).css("height","48px"),n.css("display","block"))}),n.keypress(function(n){n.which==13&&WCMS.Social.autoSizeTextbox($(n.target),16,48)}),n.keyup(function(n){n.keyCode==8&&WCMS.Social.autoSizeTextbox($(n.target),16,48)}))},execDisplayCommentPanel:function(n){n.each(function(){$(this).children("div.allComments").children().length>0&&$(this).css("display","block")})},autoSizeTextbox:function(n,t,i){var u=$(n).val().split(/\r?\n|\r/).length,r=t*u+15;$(n).css("height",(r>=i?r:i)+"px")}};WCMS.Social.bindNewPostFocus();WCMS.Social.bindPostHover($("#panelWallUpdates div.panelWallPost"));WCMS.Social.bindDeleteButtonHover($("a.postDeleteButton, a.commentDeleteButton"));WCMS.Social.bindPostDeleteClick($("#panelWallUpdates div.panelWallPost a.postDeleteButton"));WCMS.Social.bindCommentHover($("div.commentItem"));WCMS.Social.bindCommentDeleteClick($("div.commentItem a.commentDeleteButton"));WCMS.Social.bindCommentLinkClick($("a.commentAction"));WCMS.Social.bindNewCommentKeypress($("div.panelComments div.newComment textarea"));WCMS.Social.execDisplayCommentPanel($("div.panelComments"));
//# sourceMappingURL=social.min.js.map
